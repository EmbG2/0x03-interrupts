This code is a merge of all branches, and is also the most updated version with timer in interrupt
